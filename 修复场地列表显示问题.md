# 修复场地列表显示问题

## 问题原因

前端配置指向生产环境（Railway），但生产环境返回 500 错误。

## 解决方案

### 方法 1: 使用本地后端（推荐用于开发）

编辑 `Web/webapp/.env.local` 文件，修改为：

```env
# 后端 API 地址（本地开发）
NEXT_PUBLIC_API_BASE=http://localhost:4000
```

然后：
1. 确保本地后端服务正在运行：
   ```bash
   cd Server/api
   npm run dev
   ```

2. 重启前端开发服务器（如果正在运行）：
   - 在运行前端的终端按 `Ctrl+C` 停止
   - 然后重新运行：`npm run dev`

3. 硬刷新浏览器页面（`Cmd+Shift+R` 或 `Ctrl+Shift+R`）

### 方法 2: 修复生产环境

生产环境（Railway）返回 500 错误，可能是因为：
1. 数据库连接问题
2. PostGIS 列问题（和本地一样的问题）
3. 环境变量配置问题

**需要检查 Railway 部署日志**：
1. 登录 https://railway.app
2. 进入项目
3. 查看 "Deployments" 标签
4. 查看最新的部署日志，查找错误信息

**可能需要重新部署**：
- Railway 可能还没有拉取最新的代码
- 需要触发一次新的部署

## 快速修复步骤

### 立即修复（使用本地后端）

1. **编辑配置文件**：
   ```bash
   cd Web/webapp
   # 编辑 .env.local 文件
   # 将 NEXT_PUBLIC_API_BASE 改为 http://localhost:4000
   ```

2. **确认后端运行**：
   ```bash
   # 检查后端是否运行
   lsof -ti:4000
   
   # 如果没有运行，启动后端
   cd Server/api
   npm run dev
   ```

3. **重启前端**：
   - 停止前端服务（`Ctrl+C`）
   - 重新启动：`npm run dev`

4. **刷新浏览器**：
   - 硬刷新：`Cmd+Shift+R`（Mac）或 `Ctrl+Shift+R`（Windows）

## 验证修复

访问 http://localhost:3000/admin/venues，应该能看到：
- 调试信息显示 `loading: false, error: null`
- 显示场地列表
- 控制台没有错误

## 生产环境修复

如果需要使用生产环境，需要：
1. 检查 Railway 部署日志
2. 确保数据库连接正常
3. 确保环境变量配置正确
4. 可能需要重新部署最新代码


