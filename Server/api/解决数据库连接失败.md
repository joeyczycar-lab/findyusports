# 解决数据库连接失败问题

## 问题
后端服务无法启动，因为无法连接到数据库（Railway）。

## 快速解决方案

### 方案一：使用本地数据库（推荐，最稳定）⭐

1. **安装 PostgreSQL（如果还没安装）**
   ```bash
   # macOS
   brew install postgresql@14
   brew services start postgresql@14
   ```

2. **创建数据库**
   ```bash
   createdb venues
   ```

3. **修改 .env 文件**
   
   编辑 `Server/api/.env`，注释掉 Railway 数据库，使用本地数据库：
   ```bash
   # DATABASE_URL=postgresql://...
   # DB_SSL=true
   
   DB_HOST=localhost
   DB_PORT=5432
   DB_USER=postgres
   DB_PASS=postgres
   DB_NAME=venues
   ```

4. **运行数据库迁移**
   ```bash
   cd Server/api
   npm run migrate:page-view
   npm run migrate:add-contact
   npm run migrate:add-is-public
   npm run migrate:add-district-code
   ```

5. **启动服务**
   ```bash
   npm run dev
   ```

---

### 方案二：等待 Railway 数据库恢复

如果 Railway 数据库暂时不可用，等待几分钟后重试。

---

### 方案三：检查 Railway 数据库状态

1. 登录 Railway 控制台
2. 检查数据库服务是否正常运行
3. 确认数据库连接字符串是否正确

---

## 推荐：使用本地数据库

**优点**：
- ✅ 连接稳定，速度快
- ✅ 不依赖网络
- ✅ 开发更方便

**缺点**：
- ❌ 需要本地安装 PostgreSQL
- ❌ 数据不会同步到生产环境

---

## 快速检查

运行这个命令检查本地 PostgreSQL 是否运行：
```bash
psql -U postgres -c "SELECT version();"
```

如果成功，说明本地数据库可用。

